任务：

1. 将分端口和分方向的模型准确率恢复到历史最好成绩（历史最好成绩的做法只记得个大概，细节不明确）
    历史最好成绩包含下面三个特点：
    1） 删除10月1日到10月7日所有数据
    2） 分端口，方向建模
    3） 时间因素选择的是连续型变量
    4） 使用的是调参gbdt模型

2. 在原来的基础上加stacking模型和纯时间特征模型（效果比之前的好）
    1) 在使用纯时间特征时，不分端口和方向的效果要优于分端口和方向的情况


2017-05-11

1. 在单模型的基础上加上一个清洗脏数据的功能，用三层gbdt清洗掉百分之十的数据，再用五层GBDT预测（不知道为什么才0.7876）

2. 纯时间特征模型加上数值类型的时间特征（成功从0.2016提高到了0.1730）

3. stacking1使用的训练集做微小调整，在构造训练集过程中不处理nan值，拿到模型里才处理，这样训练集的Volume0～volume5和y之间更有连贯性（0.1788已经被纯时间特征超过了）


2017-05-12

1. 重新提交2017-05-11日第一个优化点（>0.3）

2. 在2017-5-11的基础上减少stacking2模型的数量，纯时间模型去掉ADAboost(0.1775)

3. 检查训练集，在2017-05-11的基础上减少stacking1模型的数据，去掉所有ADAboost模型，二层不适用随机模型，尽量减少模型之间的相关度（0.1735）

2017-05-13

1. 在2017-05-12基础上修改过滤时的评分函数

2. 修正时间特征计算代码

3. stacking的第二层备选模型中去掉随机模型（ET和RF）

description of the feature:

Traffic Volume through the Tollgates

time           datatime        the time when a vehicle passes the tollgate

tollgate_id    string          ID of the tollgate

direction      string           0:entry, 1:exit

vehicle_model  int             this number ranges from 0 to 7, which indicates the capacity of the vehicle(bigger the higher)

has_etc        string          does the vehicle use ETC (Electronic Toll Collection) device? 0: No, 1: Yes

vehicle_type   string          vehicle type: 0-passenger vehicle, 1-cargo vehicle

volume_predict.py建模思路：

创建训练集，总的要求就是以前两个小时数据为训练集，用迭代式预测方法
例如8点-10点的数据预测10点20,8点-10点20预测10点40……，每一次预测使用的都是独立的（可能模型一样）的模型
现在开始构建训练集

第一个训练集特征是所有两个小时（以20分钟为一个单位）的数据，因变量是该两小时之后20分钟的流量

第二个训练集，特征是所有两个小时又20分钟（以20分钟为一个单位）的数据，因变量是该两个小时之后20分钟的流量
以此类推训练12个GBDT模型，其中entry 6个，exit 6个

待优化思路：
1. 该模型想说明的问题是当前待预测时段的车流只和之前两小时车流有线性（或非线性）关系，这个认识其实比较局限，因此可以从
   两个方面优化：第一个是增加特征，凭经验构建特征；第二个是换一个角度思考，当前时刻的车流量也可能和之前一个月同一时段
   车流量呈线性（或非线性）关系

2. 如何证明分开考虑收费站比将收费站全部整合到一起效果好，如果将收费站整合到一起的话，那么就不对收费站id，出入方向做分类

优化思路：
1. 根据题目所给评价函数，如果将y转换成log(y)，那么损失函数可以朝lad方向梯度下降（过程已经大致证明了），而特征的log处理
   不影响CART的回归结果，所以对所有车流量（不论特征还是因变量都做log计算）。如果使用其他非树形结构模型需要考虑是否要对
   所有数据做log计算
   
volume_predict2.py
在volume_predict的基础上改进模型

建模思路：

创建训练集，总的要求就是以前两个小时数据为训练集，用迭代式预测方法

例如8点-10点的数据预测10点20,8点-10点20预测10点40……，每一次预测使用的都是独立的（可能模型一样）的模型
现在开始构建训练集

第一个训练集特征是所有两个小时（以20分钟为一个单位）的数据，因变量是该两小时之后20分钟的流量

第二个训练集，特征是所有两个小时又20分钟（以20分钟为一个单位）的数据，因变量是该两个小时之后20分钟的流量
以此类推训练12个GBDT模型，其中entry 6个，exit 6个

待优化思路：
1. 该模型想说明的问题是当前待预测时段的车流只和之前两小时车流有线性（或非线性）关系，这个认识其实比较局限，可以尝试
   换一个角度思考，当前时刻的车流量也可能和之前一个月同一时段车流量呈线性（或非线性）关系

2. 如何证明分开考虑收费站比将收费站全部整合到一起效果好，如果将收费站整合到一起的话，那么就不对收费站id，出入方向做分类

优化思路：
1. 根据题目所给评价函数，如果将y转换成log(y)，那么损失函数可以朝lad方向梯度下降（过程已经大致证明了），而特征的log处理
   不影响CART的回归结果，所以对所有车流量（不论特征还是因变量都做log计算）。如果使用其他非树形结构模型需要考虑是否要对
   所有数据做log计算

2. 增加特征，之前只考虑20分钟内的车流量情况，现在加上在20分钟内的总载重量，平均载重量；货车数量，货车总载重量，货车平均
   载重量；客车数量，客车总载重量，客车平均载重量；使用电子桩的车数（2个小时6个时段，每个时段有10维特征，一共60维）；
   2小时内总载重量，平均载重量，货车数量，货车总载重量，货车平均载重量，客车数量，客车总载重量，客车平均载重量（10维）；
   总计70维特征
